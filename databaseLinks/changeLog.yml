databaseChangeLog:
  - preConditions:
    - dbms:
        type: oracle

  - changeSet:
      author: drsteini
      id: create.database.link.nemi.er.usgs.gov
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 0
            sql: select count(*) from user_objects where object_name = 'NEMI.ER.USGS.GOV' and object_type = 'DATABASE LINK';
      changes:
        - sql: create database link nemi.er.usgs.gov connect to nemi_data identified by "${nemi_data_pwd}" using 'dbtrans.er.usgs.gov';
        - rollback: drop database link nemi.er.usgs.gov;

  - changeSet:
      author: drsteini
      id: create.database.link.nwq_data_checks.er.usgs.gov
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 0
            sql: select count(*) from user_objects where object_name = 'NWQ_DATA_CHECKS.ER.USGS.GOV' and object_type = 'DATABASE LINK';
      changes:
        - sql: create database link nwq_data_checks.er.usgs.gov connect to nwq_data_checks identified by "${nwq_data_checks_pwd}" using 'dbnolog.er.usgs.gov';
        - rollback: drop database link nwq_data_checks.er.usgs.gov;

  - changeSet:
      author: drsteini
      id: create.database.link.natdb.er.usgs.gov
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 0
            sql: select count(*) from user_objects where object_name = 'NATDB.ER.USGS.GOV' and object_type = 'DATABASE LINK';
      changes:
        - sql: create database link natdb.er.usgs.gov connect to nawqadb identified by "${nawqadb_pwd}" using 'natprod.er.usgs.gov:1521/natprod.usgs.gov';
        - rollback: drop database link natdb.er.usgs.gov;
